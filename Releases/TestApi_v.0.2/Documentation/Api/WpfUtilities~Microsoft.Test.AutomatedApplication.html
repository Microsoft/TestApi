<html dir="LTR" xmlns:ndoc="urn:ndoc-schema">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
    <title>AutomatedApplication Class</title>
    <xml>
    </xml>
    <link rel="stylesheet" type="text/css" href="MSDN.css" />
  </head>
  <body id="bodyID" class="dtBODY">
    <div id="nsbanner">
      <div id="bannerrow1">
        <table class="bannerparthead" cellspacing="0">
          <tr id="hdr">
            <td class="runninghead">TestApi 0.2</td>
            <td class="product">
            </td>
          </tr>
        </table>
      </div>
      <div id="TitleRow">
        <h1 class="dtH1">AutomatedApplication Class</h1>
      </div>
    </div>
    <div id="nstext">
      <p> The AutomatedApplication class allows the user to load and start a test application either in the current process or in a new, separate process. The application is described using either InProcessSettings or OutOfProcessSettings which enable setting delegates and describe the application to launch. These delegates are called when the applcation's main window opens and/or when the application exits. </p>
      <p>For a list of all members of this type, see <a href="WpfUtilities~Microsoft.Test.AutomatedApplication~Members.html">AutomatedApplication Members</a>.</p>
      <p>
        <a href="http://msdn.microsoft.com/en-us/library/System.Object(VS.90).aspx">System.Object</a>
        <br />   <b>AutomatedApplication</b></p>
      <div class="syntax">
        <div>public class AutomatedApplication<b> : <a href="">MarshalByRefObject</a></b></div>
      </div>
      <H4 class="dtH4">Thread Safety</H4>
      <P>
          Public static (<b>Shared</b> in Visual Basic) members of this type are
          safe for multithreaded operations. Instance members are <b>not</b> guaranteed to be
          thread-safe.
        </P>
      <h4 class="dtH4">Example</h4>
      <p> The following example shows in-process usage. The code runs the target application in a separate thread within the current process. <pre class="code">    public void MyTest()
    {
        InProcessSettings settings = new InProcessSettings(
            "c:\\myTestApp.exe",
            "MyTestApp",
            OnMainWindowCreated,
            OnExit);
        
        AutomatedApplication a = AutomatedApplication.Start(settings);
        a.WaitForMainWindow(TimeSpan.FromSeconds(5));
        
        // Perform various tests...

        a.Close();
    }
     
    private static void OnMainWindowCreated(AutomatedApplication ap)
    {
        Console.WriteLine("The main window of the application was created.");
    }

    private static void OnExit(AutomatedApplication a)
    {
        Console.WriteLine("The application has exited.");
    }
</pre> The following example demonstrates out-of-process usage: <pre class="code">    public void MyTest()
    {
        ProcessStartInfo psi = new ProcessStartInfo("c:\\myTestApp.exe");
        OutOfProcessSettings settings = new OutOfProcessSettings(
            psi,
            OnMainWindowOpened,
            OnExit);
     
        AutomatedApplication a = AutomatedApplication.Start(settings);
        a.WaitForMainWindow(TimeSpan.FromSeconds(5));
     
        // Perform various tests...
      
        a.Close();
    }

    private static void OnMainWindowCreated(AutomatedApplication ap)
    {
        Console.WriteLine("The main window of the application was created.");
    }

    private static void OnExit(AutomatedApplication ap)
    {
        Console.WriteLine("The application has exited.");
    }
</pre></p>
      <h4 class="dtH4">Requirements</h4>
      <p>
        <b>Namespace: </b>
        <a href="~Microsoft.Test.html">Microsoft.Test</a>
      </p>
      <p>
        <b>Assembly: </b>WpfUtilities (in WpfUtilities.dll)
					</p>
      <h4 class="dtH4">See Also</h4>
      <p>
        <a href="WpfUtilities~Microsoft.Test.AutomatedApplication~Members.html">AutomatedApplication Members</a> | <a href="~Microsoft.Test.html">Microsoft.Test Namespace</a></p>
      <object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e" viewastext="true" style="display: none;">
        <param name="Keyword" value="AutomatedApplication class, about AutomatedApplication class">
        </param>
      </object>
    </div>
  </body>
</html>