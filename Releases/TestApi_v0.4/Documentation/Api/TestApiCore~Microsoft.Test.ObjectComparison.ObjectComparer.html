<html dir="LTR" xmlns:ndoc="urn:ndoc-schema">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" />
    <title>ObjectComparer Class</title>
    <xml>
    </xml>
    <link rel="stylesheet" type="text/css" href="MSDN.css" />
  </head>
  <body id="bodyID" class="dtBODY">
    <div id="nsbanner">
      <div id="bannerrow1">
        <table class="bannerparthead" cellspacing="0">
          <tr id="hdr">
            <td class="runninghead">TestApi 0.4</td>
            <td class="product">
            </td>
          </tr>
        </table>
      </div>
      <div id="TitleRow">
        <h1 class="dtH1">ObjectComparer Class</h1>
      </div>
    </div>
    <div id="nstext">
      <p> Represents a generic object comparer. This class uses an <seealso cref="P:Microsoft.Test.ObjectComparison.ObjectComparer.ObjectGraphFactory" xmlns="urn:ndoc-schema"></seealso> instance to convert objects to graph representations before comparing the representations. </p>
      <p>For a list of all members of this type, see <a href="TestApiCore~Microsoft.Test.ObjectComparison.ObjectComparer~Members.html">ObjectComparer Members</a>.</p>
      <p>
        <a href="http://msdn.microsoft.com/en-us/library/System.Object(VS.90).aspx">System.Object</a>
        <br />   <b>ObjectComparer</b></p>
      <div class="syntax">
        <div>public sealed class ObjectComparer</div>
      </div>
      <H4 class="dtH4">Thread Safety</H4>
      <P>
          Public static (<b>Shared</b> in Visual Basic) members of this type are
          safe for multithreaded operations. Instance members are <b>not</b> guaranteed to be
          thread-safe.
        </P>
      <h4 class="dtH4">Remarks</h4>
      <p> Comparing two objects for equivalence is a relatively common task during test validation. One example would be to test whether a type follows the rules required by a particular serializer by saving and loading the object and comparing the two. A deep object comparison is one where all the properties and its properties are compared repeatedly until primitives are reached. The .NET Framework provides mechanisms to perform such comparisons but requires the types in question to implement part of the comparison logic (IComparable, .Equals). However, there are often types that do not follow these mechanisms. This API provides a mechanism to deep compare two objects using reflection. </p>
      <h4 class="dtH4">Example</h4>
      <p>
        <p xmlns="urn:ndoc-schema">The following example demonstrates how to compare two objects using a general-purpose object comparison strategy (represented by <a href="TestApiCore~Microsoft.Test.ObjectComparison.PublicPropertyObjectGraphFactory.html" xmlns="">PublicPropertyObjectGraphFactory</a>).</p>
        <pre class="code">// create an ObjectGraph factory
ObjectGraphFactory factory = new PublicPropertyObjectGraphFactory();

// instantiate the reusable comparer by passing the factory
ObjectComparer comparer = new ObjectComparer(factory);

// perform the compare operation
bool match = comparer.Compare(obj1, obj2);
if (!match)
{
    Console.WriteLine("The two objects do not match.");
}
</pre>
        <p xmlns="urn:ndoc-schema">In addition, the object comparison API allows the user to get back a number of comparison mismatches (in the form of <a href="TestApiCore~Microsoft.Test.ObjectComparison.ObjectComparisonMismatch.html" xmlns="">ObjectComparisonMismatch</a> objects). The following example demonstrates how to do that.</p>
        <pre class="code">// create a list to hold the mismatches
IEnumerable&lt;ObjectComparisonMismatch&gt; mismatches = new List&lt;ObjectComparisonMismatch&gt;();
   
// if the objects don't match, print out the mismatches
bool match = comparer.Compare(obj1, obj2, out mismatches);
if (!match)
{ 
    foreach (ObjectComparisonMismatch mismatch in mismatches)
    {
        Console.WriteLine(
            String.Format(
                "Nodes '{0}' and '{1}' do not match. Mismatch message: '{3}'", 
                mismatch.LeftObjectNode.Name,
                mismatch.RightObjectNode.Name,
                mismatch.Description));
    }
}
</pre>
      </p>
      <h4 class="dtH4">Requirements</h4>
      <p>
        <b>Namespace: </b>
        <a href="~Microsoft.Test.ObjectComparison.html">Microsoft.Test.ObjectComparison</a>
      </p>
      <p>
        <b>Assembly: </b>TestApiCore (in TestApiCore.dll)
					</p>
      <h4 class="dtH4">See Also</h4>
      <p>
        <a href="TestApiCore~Microsoft.Test.ObjectComparison.ObjectComparer~Members.html">ObjectComparer Members</a> | <a href="~Microsoft.Test.ObjectComparison.html">Microsoft.Test.ObjectComparison Namespace</a> | <a href="TestApiCore~Microsoft.Test.ObjectComparison.ObjectComparer.ObjectGraphFactory.html">ObjectGraphFactory</a></p>
      <object type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e" viewastext="true" style="display: none;">
        <param name="Keyword" value="ObjectComparer class, about ObjectComparer class">
        </param>
      </object>
    </div>
  </body>
</html>